# Camrbidge SKA Science Data Challenge 3 (SKA SDC3) - Foregrounds
## OSKAR Simulation
The first step is to remove the point sources by performing an [`OSKAR`](https://github.com/OxfordSKA/OSKAR) ([Dulwich et al., 2009](https://pos.sissa.it/132/031/pdf)) simulation of those with the same settings as the SKA SDC3. The SKA End-to-End simulation pipeline we used can be found [here](https://github.com/ycliu23/SKA_Power_Spectrum_and_EoR_Window), 
which is based on [this version](https://github.com/oharao/SKA_Power_Spectrum_and_EoR_Window) with a modified sky model. The full sky is composed of an outer sky that covers the $\mathrm{2\pi}$ steradians above the horizon and an inner sky model defined within the first null of the station beam pattern at 106 MHz. The point source model we used is the composite GLEAM and LoBES source catalogue provided by the SKAO and can be found [here](https://drive.google.com/file/d/14nfYmwlyqL7NzMqWtMxYfaFBccrjxKll/view?usp=drive_link). The mock observation covers 4 hours to track the point sources in the catalogue and consists of 1440 time steps, each integrating over 10 seconds. The simulation also spans the same frequency range as in the SDC3 from 106 MHz to 196 MHz, with intervals of 0.1 MHz.

The setting passed to `OSKAR`:

FILENAME = 'gleam_lobes'
MIN_FREQ = 106 # MHz
MAX_FREQ = 196 # MHz
FREQ_INTERVAL = 0.1 # MHz
STATION = 'ska_one_station'
OBS_START_TIME = '2021-09-21 14:12:40.13'
OBS_LENGTH = '04:00:00'
OBS_NUM_TIMES = 1440
INT_TIME = 10
EOR = False
DIFFUSE = True
PS = True
NOISE = False

## Imaging
The imaging process utilizes `WSCLEAN` ([Offringa et al., 2014](https://arxiv.org/pdf/1407.1943.pdf)) to grid and inverse Fourier transform the visibilities generated by `OSKAR` to images by accounting for the sky curvature (ie. w-terms) and synthesized beam patterns (ie. point spread functions).
<br>

`WSCLEAN`: "wsclean -reorder -use-wgridder -parallel-gridding 10 -weight natural -oversampling 4095 -kernel-size 15 -nwlayers 1000 -grid-mode kb -taper-edge 100 -padding 2 -name outfile -size 256 256 -scale 128asec -niter 0 -pol xx -make-psf infile" 
<br>
where infile is the input `MeasurementSet` files that contain visibility data and outfile is the output image file WSCLEAN will generate.

## Foreground Removal
use Gaussian Process Regression and nested sampling

## Power Spectrum Analysis
